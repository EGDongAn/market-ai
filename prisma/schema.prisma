generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model ai_chat_sessions {
  id         Int      @id @default(autoincrement())
  title      String?
  messages   Json
  context    Json?
  created_at DateTime @default(now())
  updated_at DateTime
}

model audit_logs {
  id          Int      @id @default(autoincrement())
  user_id     String?
  action      String
  entity_type String
  entity_id   Int?
  detail      Json?
  created_at  DateTime @default(now())
  users       users?   @relation(fields: [user_id], references: [id])
}

model brands {
  id               Int      @id @default(autoincrement())
  name             String   @unique
  name_en          String?
  manufacturer     String
  distributor      String?
  category         String
  official_url     String?
  product_page_url String?
  logo_url         String?
  description      String?
  is_active        Boolean  @default(true)
  created_at       DateTime @default(now())
  updated_at       DateTime
}

model company_settings {
  id                Int      @id @default(autoincrement())
  name              String
  business_number   String?
  representative    String?
  address           String?
  phone             String?
  fax               String?
  email             String?
  business_type     String?
  business_category String?
  created_at        DateTime @default(now())
  updated_at        DateTime
}

model contacts {
  id         Int      @id @default(autoincrement())
  partner_id Int
  name       String
  department String?
  position   String?
  phone      String?
  mobile     String?
  email      String?
  is_primary Boolean  @default(false)
  notes      String?
  created_at DateTime @default(now())
  updated_at DateTime
  partners   partners @relation(fields: [partner_id], references: [id], onDelete: Cascade)
  items      items[]
}

model influencer_analyses {
  id                      Int            @id @default(autoincrement())
  influencer_id           Int
  instagram_followers     Int?
  instagram_engagement    Decimal?       @db.Decimal(5, 2)
  youtube_subscribers     Int?
  youtube_avg_views       Int?
  tiktok_followers        Int?
  tiktok_engagement       Decimal?       @db.Decimal(5, 2)
  calculated_tier         InfluencerTier
  tier_score              Decimal        @db.Decimal(5, 2)
  analysis_summary        String?
  analysis_raw            Json?
  recommended_support_min Decimal?       @db.Decimal(12, 2)
  recommended_support_max Decimal?       @db.Decimal(12, 2)
  analyzed_at             DateTime       @default(now())
  influencers             influencers    @relation(fields: [influencer_id], references: [id], onDelete: Cascade)

  @@index([analyzed_at])
  @@index([influencer_id])
}

model influencer_procedure_supports {
  id                Int                @id @default(autoincrement())
  influencer_id     Int
  procedure_id      Int
  visit_id          Int?
  procedure_cost    Decimal            @db.Decimal(12, 2)
  supported_amount  Decimal            @db.Decimal(12, 2)
  client_payment    Decimal            @db.Decimal(12, 2)
  status            SupportStatus      @default(SCHEDULED)
  scheduled_at      DateTime?
  completed_at      DateTime?
  notes             String?
  created_at        DateTime           @default(now())
  updated_at        DateTime
  influencers       influencers        @relation(fields: [influencer_id], references: [id], onDelete: Cascade)
  procedures        procedures         @relation(fields: [procedure_id], references: [id])
  influencer_visits influencer_visits? @relation(fields: [visit_id], references: [id])

  @@index([influencer_id])
  @@index([procedure_id])
  @@index([status])
}

model influencer_visits {
  id                            Int                             @id @default(autoincrement())
  influencer_id                 Int
  visit_date                    DateTime
  purpose                       String?
  content_posted                Boolean                         @default(false)
  content_urls                  Json?
  notes                         String?
  created_at                    DateTime                        @default(now())
  updated_at                    DateTime
  influencer_procedure_supports influencer_procedure_supports[]
  influencers                   influencers                     @relation(fields: [influencer_id], references: [id], onDelete: Cascade)

  @@index([influencer_id])
  @@index([visit_date])
}

model influencers {
  id                            Int                             @id @default(autoincrement())
  name                          String
  nickname                      String?
  email                         String?
  phone                         String?
  instagram_handle              String?
  youtube_channel               String?
  tiktok_handle                 String?
  blog_url                      String?
  current_tier                  InfluencerTier                  @default(C)
  tier_score                    Decimal?                        @db.Decimal(5, 2)
  last_analyzed_at              DateTime?
  total_visits                  Int                             @default(0)
  total_supported               Decimal                         @default(0) @db.Decimal(12, 2)
  notes                         String?
  is_active                     Boolean                         @default(true)
  is_blacklisted                Boolean                         @default(false)
  blacklist_reason              String?
  created_at                    DateTime                        @default(now())
  updated_at                    DateTime
  influencer_analyses           influencer_analyses[]
  influencer_procedure_supports influencer_procedure_supports[]
  influencer_visits             influencer_visits[]

  @@index([current_tier])
  @@index([is_active])
}

model invoice_hashes {
  id              Int       @id @default(autoincrement())
  hash            String    @unique
  partner_id      Int?
  invoice_date    DateTime? @db.Date
  total_amount    Decimal?  @db.Decimal(12, 2)
  item_count      Int
  raw_content     String?
  processed_at    DateTime  @default(now())
  transaction_ids String?
  partners        partners? @relation(fields: [partner_id], references: [id])
}

model item_barcodes {
  id            Int     @id @default(autoincrement())
  item_id       Int
  barcode_value String  @unique
  barcode_type  String?
  label         String?
  items         items   @relation(fields: [item_id], references: [id], onDelete: Cascade)
}

model item_lots {
  id                 Int                  @id @default(autoincrement())
  item_id            Int
  lot_number         String
  expiry_date        DateTime?            @db.Date
  initial_qty        Int
  current_qty        Int
  location_id        Int?
  created_at         DateTime             @default(now())
  items              items                @relation(fields: [item_id], references: [id], onDelete: Cascade)
  locations          locations?           @relation(fields: [location_id], references: [id])
  loan_items         loan_items[]
  stock_transactions stock_transactions[]

  @@unique([item_id, lot_number, location_id])
}

model item_matching_logs {
  id               Int      @id @default(autoincrement())
  partner_id       Int?
  input_name       String
  matched_item_id  Int?
  candidate_ids    Json?
  candidate_scores Json?
  match_method     String?
  confidence       Float?
  user_action      String?
  user_selection   Int?
  resolved         Boolean  @default(false)
  created_at       DateTime @default(now())

  @@index([partner_id])
  @@index([resolved])
}

model items {
  id                                                 Int                     @id @default(autoincrement())
  name                                               String
  category                                           String
  subcategory                                        String?
  brand                                              String?
  model                                              String?
  unit                                               String?
  storage_condition                                  String?
  description                                        String?
  image_url                                          String?
  created_at                                         DateTime                @default(now())
  updated_at                                         DateTime
  distributor                                        String?
  manufacturer                                       String?
  brand_en                                           String?
  category_en                                        String?
  distributor_en                                     String?
  manufacturer_en                                    String?
  name_en                                            String?
  subcategory_en                                     String?
  order_contact_name                                 String?
  order_contact_phone                                String?
  order_login_id                                     String?
  order_login_pw                                     String?
  order_method                                       String?
  order_website                                      String?
  usage_manual                                       String?
  aliases                                            Json?
  accessories                                        Json?
  packaging_desc                                     String?
  total_volume                                       Float?
  unit_type                                          String?
  unit_volume                                        Float?
  unit_volume_unit                                   String?
  units_per_box                                      Int?
  boxes_per_carton                                   Int?
  order_contact_id                                   Int?
  needs_order                                        Boolean?                @default(false)
  default_in_location_id                             Int?
  default_out_location_id                            Int?
  min_stock                                          Int?
  item_barcodes                                      item_barcodes[]
  item_lots                                          item_lots[]
  locations_items_default_in_location_idTolocations  locations?              @relation("items_default_in_location_idTolocations", fields: [default_in_location_id], references: [id])
  locations_items_default_out_location_idTolocations locations?              @relation("items_default_out_location_idTolocations", fields: [default_out_location_id], references: [id])
  contacts                                           contacts?               @relation(fields: [order_contact_id], references: [id])
  loan_items                                         loan_items[]
  partner_item_mappings                              partner_item_mappings[]
  procedure_items                                    procedure_items[]
  stock_transactions                                 stock_transactions[]
}

model loan_items {
  id        Int        @id @default(autoincrement())
  loan_id   Int
  item_id   Int
  qty       Int
  lot_id    Int?
  items     items      @relation(fields: [item_id], references: [id], onDelete: Cascade)
  loans     loans      @relation(fields: [loan_id], references: [id], onDelete: Cascade)
  item_lots item_lots? @relation(fields: [lot_id], references: [id])
}

model loans {
  id              Int           @id @default(autoincrement())
  partner_id      Int
  direction       LoanDirection
  status          LoanStatus    @default(ONGOING)
  start_date      DateTime      @db.Date
  expected_return DateTime?     @db.Date
  actual_return   DateTime?     @db.Date
  note            String?
  created_at      DateTime      @default(now())
  loan_items      loan_items[]
  partners        partners      @relation(fields: [partner_id], references: [id], onDelete: Cascade)
}

model locations {
  id                                                                Int                  @id @default(autoincrement())
  code                                                              String               @unique
  name                                                              String
  type                                                              String
  parent_id                                                         Int?
  qr_value                                                          String
  is_active                                                         Boolean              @default(true)
  created_at                                                        DateTime             @default(now())
  item_lots                                                         item_lots[]
  items_items_default_in_location_idTolocations                     items[]              @relation("items_default_in_location_idTolocations")
  items_items_default_out_location_idTolocations                    items[]              @relation("items_default_out_location_idTolocations")
  locations                                                         locations?           @relation("locationsTolocations", fields: [parent_id], references: [id])
  other_locations                                                   locations[]          @relation("locationsTolocations")
  stock_transactions_stock_transactions_from_location_idTolocations stock_transactions[] @relation("stock_transactions_from_location_idTolocations")
  stock_transactions_stock_transactions_to_location_idTolocations   stock_transactions[] @relation("stock_transactions_to_location_idTolocations")
}

model manual_attachments {
  id         Int      @id @default(autoincrement())
  manual_id  Int
  file_name  String
  file_url   String
  file_size  Int?
  mime_type  String?
  created_at DateTime @default(now())
  manuals    manuals  @relation(fields: [manual_id], references: [id], onDelete: Cascade)

  @@index([manual_id])
}

model manual_categories {
  id                      Int                 @id @default(autoincrement())
  name                    String
  description             String?
  parent_id               Int?
  order                   Int                 @default(0)
  created_at              DateTime            @default(now())
  updated_at              DateTime
  manual_categories       manual_categories?  @relation("manual_categoriesTomanual_categories", fields: [parent_id], references: [id])
  other_manual_categories manual_categories[] @relation("manual_categoriesTomanual_categories")
  manuals                 manuals[]
}

model manual_chunks {
  id               Int                   @id @default(autoincrement())
  manual_id        Int
  chunk_index      Int
  content          String
  section_title    String?
  start_offset     Int
  end_offset       Int
  token_count      Int
  content_hash     String
  embedding        Bytes
  embedding_vector Unsupported("vector")
  created_at       DateTime              @default(now())
  updated_at       DateTime
  manuals          manuals               @relation(fields: [manual_id], references: [id], onDelete: Cascade)

  @@unique([manual_id, chunk_index])
  @@index([content_hash])
  @@index([manual_id])
}

model manual_embeddings {
  id               Int                   @id @default(autoincrement())
  manual_id        Int                   @unique
  embedding        Bytes
  embedding_vector Unsupported("vector")
  content_hash     String
  created_at       DateTime              @default(now())
  updated_at       DateTime
  manuals          manuals               @relation(fields: [manual_id], references: [id], onDelete: Cascade)
}

model manual_tags {
  id      Int       @id @default(autoincrement())
  name    String    @unique
  manuals manuals[]
}

model manual_versions {
  id          Int      @id @default(autoincrement())
  manual_id   Int
  title       String
  content     String
  version     Int
  changed_by  String?
  change_note String?
  created_at  DateTime @default(now())
  manuals     manuals  @relation(fields: [manual_id], references: [id], onDelete: Cascade)

  @@index([manual_id])
}

model manuals {
  id                 Int                  @id @default(autoincrement())
  title              String
  content            String
  summary            String?
  category_id        Int?
  status             ManualStatus         @default(DRAFT)
  version            Int                  @default(1)
  view_count         Int                  @default(0)
  created_by         String?
  updated_by         String?
  created_at         DateTime             @default(now())
  updated_at         DateTime
  manual_attachments manual_attachments[]
  manual_chunks      manual_chunks[]
  manual_embeddings  manual_embeddings?
  manual_versions    manual_versions[]
  manual_categories  manual_categories?   @relation(fields: [category_id], references: [id])
  procedure_manuals  procedure_manuals[]
  manual_tags        manual_tags[]

  @@index([category_id])
  @@index([status])
}

model market_alert_history {
  id             Int           @id @default(autoincrement())
  alert_id       Int
  triggered_at   DateTime?     @default(now()) @db.Timestamp(6)
  old_value      Decimal?      @db.Decimal(12, 2)
  new_value      Decimal?      @db.Decimal(12, 2)
  change_percent Decimal?      @db.Decimal(5, 2)
  message        String?
  is_read        Boolean?      @default(false)
  market_alerts  market_alerts @relation(fields: [alert_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([alert_id], map: "idx_market_alert_history_alert")
}

model market_alerts {
  id                   Int                    @id @default(autoincrement())
  alert_type           String                 @db.VarChar(50)
  procedure_id         Int?
  competitor_id        Int?
  threshold_percent    Decimal?               @db.Decimal(5, 2)
  threshold_value      Decimal?               @db.Decimal(12, 2)
  is_active            Boolean?               @default(true)
  email_notify         Boolean?               @default(true)
  push_notify          Boolean?               @default(false)
  created_at           DateTime?              @default(now()) @db.Timestamp(6)
  updated_at           DateTime?              @default(now()) @db.Timestamp(6)
  market_alert_history market_alert_history[]
  market_competitors   market_competitors?    @relation(fields: [competitor_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  market_procedures    market_procedures?     @relation(fields: [procedure_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model market_competitors {
  id                   Int                    @id @default(autoincrement())
  name                 String                 @unique @db.VarChar(255)
  website              String?
  region               String?                @db.VarChar(100)
  type                 String?                @db.VarChar(50)
  is_active            Boolean?               @default(true)
  crawl_priority       Int?                   @default(5)
  crawl_config         Json?
  last_crawled_at      DateTime?              @db.Timestamp(6)
  created_at           DateTime?              @default(now()) @db.Timestamp(6)
  updated_at           DateTime?              @default(now()) @db.Timestamp(6)
  market_alerts        market_alerts[]
  market_crawl_configs market_crawl_configs[]
  market_prices        market_prices[]
}

model market_crawl_configs {
  id                 Int                @id @default(autoincrement())
  competitor_id      Int
  config_type        String             @db.VarChar(50)
  selectors          Json?
  schedule           String?            @db.VarChar(100)
  is_active          Boolean?           @default(true)
  last_run_at        DateTime?          @db.Timestamp(6)
  last_run_status    String?            @db.VarChar(20)
  created_at         DateTime?          @default(now()) @db.Timestamp(6)
  updated_at         DateTime?          @default(now()) @db.Timestamp(6)
  market_competitors market_competitors @relation(fields: [competitor_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model market_our_prices {
  id                Int               @id @default(autoincrement())
  procedure_id      Int
  regular_price     Decimal?          @db.Decimal(12, 2)
  event_price       Decimal?          @db.Decimal(12, 2)
  cost_price        Decimal?          @db.Decimal(12, 2)
  target_margin     Decimal?          @db.Decimal(5, 2)
  is_active         Boolean?          @default(true)
  valid_from        DateTime?         @db.Timestamp(6)
  valid_until       DateTime?         @db.Timestamp(6)
  created_at        DateTime?         @default(now()) @db.Timestamp(6)
  updated_at        DateTime?         @default(now()) @db.Timestamp(6)
  market_procedures market_procedures @relation(fields: [procedure_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model market_package_items {
  id                Int               @id @default(autoincrement())
  package_id        Int
  procedure_id      Int
  quantity          Int?              @default(1)
  discount_percent  Decimal?          @default(0) @db.Decimal(5, 2)
  created_at        DateTime?         @default(now()) @db.Timestamp(6)
  market_packages   market_packages   @relation(fields: [package_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  market_procedures market_procedures @relation(fields: [procedure_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model market_packages {
  id                   Int                    @id @default(autoincrement())
  name                 String                 @db.VarChar(255)
  description          String?
  regular_price        Decimal?               @db.Decimal(12, 2)
  package_price        Decimal?               @db.Decimal(12, 2)
  is_ai_suggested      Boolean?               @default(false)
  ai_rationale         String?
  is_active            Boolean?               @default(true)
  created_at           DateTime?              @default(now()) @db.Timestamp(6)
  updated_at           DateTime?              @default(now()) @db.Timestamp(6)
  market_package_items market_package_items[]
}

model market_prices {
  id                 Int                @id @default(autoincrement())
  competitor_id      Int
  procedure_id       Int
  regular_price      Decimal?           @db.Decimal(12, 2)
  event_price        Decimal?           @db.Decimal(12, 2)
  unit_count         Int?               @default(1)
  source_url         String?
  crawled_at         DateTime?          @default(now()) @db.Timestamp(6)
  created_at         DateTime?          @default(now()) @db.Timestamp(6)
  market_competitors market_competitors @relation(fields: [competitor_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  market_procedures  market_procedures  @relation(fields: [procedure_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([competitor_id], map: "idx_market_prices_competitor")
  @@index([crawled_at], map: "idx_market_prices_crawled_at")
  @@index([procedure_id], map: "idx_market_prices_procedure")
}

model market_procedure_categories {
  id                             Int                              @id @default(autoincrement())
  name                           String                           @unique @db.VarChar(100)
  description                    String?
  sort_order                     Int?                             @default(0)
  is_active                      Boolean?                         @default(true)
  created_at                     DateTime?                        @default(now()) @db.Timestamp(6)
  updated_at                     DateTime?                        @default(now()) @db.Timestamp(6)
  market_procedure_subcategories market_procedure_subcategories[]
}

model market_procedure_embeddings {
  id                Int               @id @default(autoincrement())
  procedure_id      Int               @unique
  embedding         Json
  content           String?
  created_at        DateTime?         @default(now()) @db.Timestamp(6)
  updated_at        DateTime?         @default(now()) @db.Timestamp(6)
  market_procedures market_procedures @relation(fields: [procedure_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model market_procedure_subcategories {
  id                          Int                         @id @default(autoincrement())
  category_id                 Int
  name                        String                      @db.VarChar(100)
  description                 String?
  sort_order                  Int?                        @default(0)
  is_active                   Boolean?                    @default(true)
  created_at                  DateTime?                   @default(now()) @db.Timestamp(6)
  updated_at                  DateTime?                   @default(now()) @db.Timestamp(6)
  market_procedure_categories market_procedure_categories @relation(fields: [category_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  market_procedures           market_procedures[]

  @@unique([category_id, name])
}

model market_procedures {
  id                             Int                             @id @default(autoincrement())
  name                           String                          @db.VarChar(255)
  subcategory_id                 Int?
  aliases                        String[]
  brand                          String?                         @db.VarChar(100)
  unit                           String?                         @db.VarChar(50)
  description                    String?
  is_active                      Boolean?                        @default(true)
  created_at                     DateTime?                       @default(now()) @db.Timestamp(6)
  updated_at                     DateTime?                       @default(now()) @db.Timestamp(6)
  market_alerts                  market_alerts[]
  market_our_prices              market_our_prices[]
  market_package_items           market_package_items[]
  market_prices                  market_prices[]
  market_procedure_embeddings    market_procedure_embeddings?
  market_procedure_subcategories market_procedure_subcategories? @relation(fields: [subcategory_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([subcategory_id], map: "idx_market_procedures_subcategory")
}

model partner_item_mappings {
  id                Int      @id @default(autoincrement())
  partner_id        Int
  item_id           Int
  partner_item_name String
  partner_item_code String?
  usage_count       Int      @default(1)
  confidence        Float    @default(1.0)
  source            String   @default("manual")
  created_at        DateTime @default(now())
  updated_at        DateTime
  items             items    @relation(fields: [item_id], references: [id], onDelete: Cascade)
  partners          partners @relation(fields: [partner_id], references: [id], onDelete: Cascade)

  @@unique([partner_id, partner_item_name])
  @@index([partner_id])
}

model partners {
  id                    Int                     @id @default(autoincrement())
  name                  String
  business_number       String?
  representative        String?
  address               String?
  phone                 String?
  type                  String?
  created_at            DateTime                @default(now())
  invoice_config        Json?
  invoice_history       Json?
  updated_at            DateTime                @default(now())
  contacts              contacts[]
  invoice_hashes        invoice_hashes[]
  loans                 loans[]
  partner_item_mappings partner_item_mappings[]
  stock_transactions    stock_transactions[]
}

model procedure_costs {
  id           Int        @id @default(autoincrement())
  procedure_id Int
  cost_type    CostType
  name         String
  amount       Decimal    @db.Decimal(12, 2)
  unit         String?
  calculation  String?
  created_at   DateTime   @default(now())
  updated_at   DateTime
  procedures   procedures @relation(fields: [procedure_id], references: [id], onDelete: Cascade)

  @@index([procedure_id])
}

model procedure_equipment {
  id             Int        @id @default(autoincrement())
  procedure_id   Int
  equipment_name String
  usage_minutes  Int?
  procedures     procedures @relation(fields: [procedure_id], references: [id], onDelete: Cascade)

  @@index([procedure_id])
}

model procedure_items {
  id           Int        @id @default(autoincrement())
  procedure_id Int
  item_id      Int
  quantity     Decimal    @db.Decimal(10, 4)
  unit         String
  is_optional  Boolean    @default(false)
  items        items      @relation(fields: [item_id], references: [id])
  procedures   procedures @relation(fields: [procedure_id], references: [id], onDelete: Cascade)

  @@unique([procedure_id, item_id])
}

model procedure_manuals {
  id            Int        @id @default(autoincrement())
  procedure_id  Int
  manual_id     Int
  relation_type String
  manuals       manuals    @relation(fields: [manual_id], references: [id], onDelete: Cascade)
  procedures    procedures @relation(fields: [procedure_id], references: [id], onDelete: Cascade)

  @@unique([procedure_id, manual_id])
}

model procedures {
  id                            Int                             @id @default(autoincrement())
  name                          String
  name_en                       String?
  category                      String
  subcategory                   String?
  description                   String?
  duration_minutes              Int
  buffer_minutes                Int                             @default(10)
  base_cost                     Decimal                         @db.Decimal(12, 2)
  is_active                     Boolean                         @default(true)
  requires_doctor               Boolean                         @default(true)
  created_at                    DateTime                        @default(now())
  updated_at                    DateTime
  influencer_procedure_supports influencer_procedure_supports[]
  procedure_costs               procedure_costs[]
  procedure_equipment           procedure_equipment[]
  procedure_items               procedure_items[]
  procedure_manuals             procedure_manuals[]

  @@index([category])
  @@index([is_active])
}

model roles {
  id          Int      @id @default(autoincrement())
  name        String   @unique
  description String?
  created_at  DateTime @default(now())
  users       users[]
}

model stock_transactions {
  id                                                       Int         @id @default(autoincrement())
  item_id                                                  Int
  lot_id                                                   Int?
  type                                                     StockTxType
  qty                                                      Int
  from_location_id                                         Int?
  to_location_id                                           Int?
  performed_by                                             String?
  partner_id                                               Int?
  note                                                     String?
  created_at                                               DateTime    @default(now())
  locations_stock_transactions_from_location_idTolocations locations?  @relation("stock_transactions_from_location_idTolocations", fields: [from_location_id], references: [id])
  items                                                    items       @relation(fields: [item_id], references: [id], onDelete: Cascade)
  item_lots                                                item_lots?  @relation(fields: [lot_id], references: [id])
  partners                                                 partners?   @relation(fields: [partner_id], references: [id])
  users                                                    users?      @relation(fields: [performed_by], references: [id])
  locations_stock_transactions_to_location_idTolocations   locations?  @relation("stock_transactions_to_location_idTolocations", fields: [to_location_id], references: [id])
}

model tier_support_policies {
  id                    Int            @id @default(autoincrement())
  tier                  InfluencerTier @unique
  max_support_per_visit Decimal        @db.Decimal(12, 2)
  max_support_per_month Decimal        @db.Decimal(12, 2)
  max_visits_per_month  Int            @default(1)
  support_rate_percent  Int
  allowed_categories    Json?
  excluded_procedures   Json?
  additional_benefits   Json?
  is_active             Boolean        @default(true)
  created_at            DateTime       @default(now())
  updated_at            DateTime
}

model users {
  id                 String               @id
  email              String               @unique
  name               String
  role_id            Int?
  created_at         DateTime             @default(now())
  audit_logs         audit_logs[]
  stock_transactions stock_transactions[]
  roles              roles?               @relation(fields: [role_id], references: [id])
}

enum CampaignStatus {
  PLANNING
  IN_PROGRESS
  COMPLETED
  CANCELLED
}

enum CampaignType {
  COLLABORATION
  ADVERTISEMENT
  EVENT
  REVIEW
  OTHER_CAMPAIGN
}

enum CollaborationStatus {
  CONTACTED
  NEGOTIATING
  CONFIRMED
  SHOOTING_DONE
  PROGRESS_DONE
  UPLOADED
  COLLAB_COMPLETED
  COLLAB_CANCELLED
}

enum ContentType {
  VIDEO
  SHORTS
  IMAGE
  BLOG
  STORY
  OTHER_CONTENT
}

enum CostType {
  LABOR
  RENT
  MATERIAL
  EQUIPMENT
  OTHER
}

enum FeeType {
  FIXED
  PER_CONTENT
  REVENUE_SHARE
  BARTER
}

enum InfPlatform {
  YOUTUBE
  INSTAGRAM
  TIKTOK
  BLOG_NAVER
  BLOG_OTHER
  FACEBOOK
  TWITTER
  OTHER
}

enum InfluencerTier {
  SS
  S
  A
  B
  C
}

enum LoanDirection {
  OUT
  IN
}

enum LoanStatus {
  ONGOING
  RETURNED
  OVERDUE
}

enum ManualStatus {
  DRAFT
  PUBLISHED
  ARCHIVED
}

enum StockTxType {
  IN
  OUT
  ADJUST
  LOAN_OUT
  LOAN_IN
  TRANSFER
}

enum SupportStatus {
  SCHEDULED
  COMPLETED
  CANCELLED
  NO_SHOW
}
